<!-- Grammar Rule -->
<div class="mb-8">
  <h2 class="text-2xl font-bold text-gray-900 mb-4">üìñ Grammar Rule: {{ content.rule.title }}</h2>
  
  <!-- Main Explanation -->
  <div class="bg-blue-50 border-l-4 border-blue-500 p-5 rounded-lg mb-4">
    <h3 class="font-semibold text-blue-900 mb-2">Definition & Structure:</h3>
    <p class="text-gray-700 whitespace-pre-line leading-relaxed">{{ content.rule.explanation }}</p>
  </div>
  
  <!-- Key Points -->
  <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
    <h3 class="font-semibold text-gray-800 mb-2 flex items-center gap-2">
      <span>‚ö°</span> Key Points to Remember:
    </h3>
    <ul class="space-y-2 text-gray-700">
      <li class="flex items-start gap-2">
        <span class="text-yellow-500 mt-1">‚Ä¢</span>
        <span>Pay attention to the subject-verb agreement</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-yellow-500 mt-1">‚Ä¢</span>
        <span>Remember the word order in different sentence types</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-yellow-500 mt-1">‚Ä¢</span>
        <span>Practice makes perfect - use these rules in your daily English</span>
      </li>
    </ul>
  </div>
</div>

<!-- Examples -->
<div class="mb-8">
  <h3 class="text-lg font-semibold text-gray-900 mb-4">üí° Examples in Context:</h3>
  <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
    <ul class="space-y-3">
      {% for example in content.rule.examples %}
      <li class="flex items-start gap-3">
        <span class="text-green-600 font-bold mt-1">‚úì</span>
        <div>
          <span class="text-gray-800 font-medium">{{ example }}</span>
          <p class="text-sm text-gray-600 mt-1">Notice the grammar pattern used here</p>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</div>

<!-- Practice Exercises -->
<div class="mb-8">
  <h3 class="text-xl font-semibold text-gray-900 mb-4">‚úçÔ∏è Practice Exercises:</h3>
  <p class="text-gray-600 mb-4">Complete the following exercises to master this grammar rule. Click "Hint" if you need help!</p>
  
  {% for exercise in content.exercises %}
  <div class="exercise mb-6 p-5 bg-gray-50 rounded-lg border border-gray-200" data-id="{{ exercise.id }}" data-type="{{ exercise.type }}" data-answer="{{ exercise.correct_answer }}">
    <div class="flex justify-between items-start mb-3">
      <div class="font-semibold text-gray-900">
        Exercise {{ forloop.counter }}: {{ exercise.question }}
      </div>
      <button class="hint-btn text-sm px-3 py-1 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 transition">
        üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞
      </button>
    </div>
    
    <div class="hint hidden mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg">
      <p class="text-sm text-blue-800">
        {% if exercise.type == 'fill_blank' %}
        –ü–æ–¥—É–º–∞–π—Ç–µ –æ –ø–æ–¥–ª–µ–∂–∞—â–µ–º –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ –≥–ª–∞–≥–æ–ª–∞.
        {% elif exercise.type == 'correct_mistake' %}
        –ù–∞–π–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ö –≥–ª–∞–≥–æ–ª–æ–≤, –ø–æ—Ä—è–¥–∫–µ —Å–ª–æ–≤ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–ª–æ–≤–∞—Ö.
        {% elif exercise.type == 'multiple_choice' %}
        –°–Ω–∞—á–∞–ª–∞ –∏—Å–∫–ª—é—á–∏—Ç–µ –æ—á–µ–≤–∏–¥–Ω–æ –Ω–µ–≤–µ—Ä–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω—ã–π.
        {% endif %}
      </p>
      <div class="correct-answer text-sm text-blue-900 mt-2"></div>
    </div>
    
    {% if exercise.type == 'fill_blank' or exercise.type == 'correct_mistake' %}
    <input type="text" class="user-answer w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç...">
    {% elif exercise.type == 'multiple_choice' %}
    <div class="space-y-2">
      {% for option in exercise.options %}
      <label class="flex items-center gap-3 p-3 border-2 border-gray-300 rounded-lg cursor-pointer hover:bg-white transition">
        <input type="radio" name="exercise_{{ exercise.id }}" value="{{ forloop.counter0 }}" class="user-answer w-4 h-4">
        <span>{{ option }}</span>
      </label>
      {% endfor %}
    </div>
    {% endif %}
    
    <button class="check-btn mt-3 px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition">
      Check Answer
    </button>
    
    <div class="result hidden mt-3 p-3 rounded-lg">
      <div class="flex items-start gap-2">
        <span class="icon text-2xl"></span>
        <div class="flex-1">
          <div class="font-semibold status-text"></div>
          <div class="explanation text-sm text-gray-700 mt-1"></div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<!-- Complete Lesson Button -->
<button id="completeBtn" class="w-full px-8 py-4 bg-green-600 text-white font-bold text-lg rounded-full hover:bg-green-700 transition shadow-lg">
  ‚úÖ Complete Lesson
</button>

<script>
const lessonId = {{ lesson.id }};
</script>
