{% extends 'main/layout.html' %}

{% block content %}
<main class="py-10">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Page header -->
    <div class="mb-8">
      <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 tracking-tight m-0">Личный кабинет</h1>
      <p class="text-base text-gray-600 mt-2 m-0">Управляйте своим профилем и отслеживайте прогресс изучения английского</p>
    </div>

    <!-- Hidden sync form -->
    <form id="profileForm" method="POST" class="hidden">
      {% csrf_token %}
      <input type="hidden" name="interests" id="hiddenInterests">
      <input type="hidden" name="goals" id="hiddenGoals">
      <input type="hidden" name="about" id="hiddenAbout">
    </form>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Left Column -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Personal Information -->
        <section class="bg-white rounded-2xl ring-1 ring-gray-200 shadow-sm overflow-hidden transition-transform duration-300 hover:-translate-y-0.5 hover:shadow-lg">
          <header class="flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gray-50/60">
            <h3 class="text-lg font-bold m-0 inline-flex items-center gap-2">
              <i class="fas fa-user text-primary w-[18px] h-[18px]" aria-hidden="true"></i>
              Персональные данные
            </h3>
            <button type="button" onclick="editProfile()"
              class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-semibold bg-white ring-1 ring-gray-200 text-gray-800 transition-all hover:text-primary hover:ring-primary hover:-translate-y-0.5 hover:shadow-md">
              <i class="fas fa-edit" aria-hidden="true"></i>
              Редактировать
            </button>
          </header>
          <div class="flex items-center gap-4 p-6">
            <div class="w-16 h-16 rounded-full bg-gradient-to-br from-primary to-emerald-700 text-white flex items-center justify-center font-bold text-xl shadow-lg ring-2 ring-white">
              <span class="sr-only">Инициалы пользователя</span>
              {{ request.user.first_name|first|upper|default:"U" }}{{ request.user.last_name|first|upper|default:"" }}
            </div>
            <div>
              <h2 class="m-0 mb-2 text-xl font-bold">{{ request.user.first_name|default:request.user.username }} {{ request.user.last_name }}</h2>
              <p class="my-1 text-base text-gray-800">
                <i class="fas fa-envelope text-primary w-4 mr-2" aria-hidden="true"></i> {{ request.user.email }}
              </p>
              <p class="my-1 text-base text-gray-800">
                <i class="fas fa-calendar text-primary w-4 mr-2" aria-hidden="true"></i> Зарегистрирован: {{ request.user.date_joined|date:"d E Y" }}
              </p>
            </div>
          </div>
        </section>

        <!-- Interests -->
        <section class="bg-white rounded-2xl ring-1 ring-gray-200 shadow-sm overflow-hidden transition-transform duration-300 hover:-translate-y-0.5 hover:shadow-lg">
          <header class="flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gray-50/60">
            <h3 class="text-lg font-bold m-0 inline-flex items-center gap-2">
              <i class="fas fa-heart text-primary w-[18px] h-[18px]" aria-hidden="true"></i>
              Интересы
            </h3>
            <button type="button" onclick="openInterestsModal()"
              class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-semibold bg-white ring-1 ring-gray-200 text-gray-800 transition-all hover:text-primary hover:ring-primary hover:-translate-y-0.5 hover:shadow-md">
              <i class="fas fa-edit" aria-hidden="true"></i>
              Изменить
            </button>
          </header>
          <div class="p-6">
            <div class="flex flex-wrap gap-3" id="interestsGrid">
              {% for interest in interests_list %}
                <div class="interest-tag group inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200 text-sm font-medium transition-all hover:shadow-md hover:-translate-y-0.5"
                     data-interest="{{ interest }}">
                  <i class="fas fa-heart w-4" aria-hidden="true"></i>
                  <span>{{ interest }}</span>
                  <button type="button" class="ml-1 inline-flex items-center justify-center rounded-full p-1 text-gray-500 hover:text-gray-800 hover:bg-blue-100 transition hidden group-hover:inline-flex"
                          onclick="removeInterest(this, event)" aria-label="Удалить интерес">
                    <i class="fas fa-times" aria-hidden="true"></i>
                  </button>
                </div>
              {% empty %}
                <p class="text-gray-500 text-sm">Интересы не указаны. Добавьте их, чтобы персонализировать обучение.</p>
              {% endfor %}
            </div>
          </div>
        </section>

        <!-- Goals -->
        <section class="bg-white rounded-2xl ring-1 ring-gray-200 shadow-sm overflow-hidden transition-transform duration-300 hover:-translate-y-0.5 hover:shadow-lg">
          <header class="flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gray-50/60">
            <h3 class="text-lg font-bold m-0 inline-flex items-center gap-2">
              <i class="fas fa-target text-primary w-[18px] h-[18px]" aria-hidden="true"></i>
              Цели изучения
            </h3>
            <button type="button" onclick="openGoalsModal()"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold text-white bg-primary hover:bg-emerald-700 transition-all hover:shadow-md">
              <i class="fas fa-plus" aria-hidden="true"></i>
              Добавить цель
            </button>
          </header>
          <div id="goalsList" class="divide-y divide-gray-100">
            {% for goal in goals_list %}
              <div class="px-6 py-4 transition-colors hover:bg-gray-50" data-goal="{{ goal }}">
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-3 font-medium">
                    <i class="fas fa-target text-primary w-4" aria-hidden="true"></i>
                    <span>{{ goal }}</span>
                  </div>
                  <div class="flex items-center gap-3">
                    <span class="px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800">Активная</span>
                    <button type="button" class="text-gray-500 p-1 rounded hover:bg-gray-200 hover:text-gray-800 transition"
                            onclick="removeGoal(this)" aria-label="Удалить цель">
                      <i class="fas fa-trash" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </div>
            {% empty %}
              <div class="px-6 py-4 text-gray-500 text-sm">Цели не установлены. Добавьте цели для более эффективного обучения.</div>
            {% endfor %}
          </div>
        </section>

        <!-- Additional Information -->
        <section class="bg-white rounded-2xl ring-1 ring-gray-200 shadow-sm overflow-hidden transition-transform duration-300 hover:-translate-y-0.5 hover:shadow-lg">
          <header class="flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gray-50/60">
            <h3 class="text-lg font-bold m-0 inline-flex items-center gap-2">
              <i class="fas fa-sticky-note text-primary w-[18px] h-[18px]" aria-hidden="true"></i>
              Дополнительная информация
            </h3>
            <button type="button" onclick="saveAdditionalInfo()"
              class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-semibold bg-white ring-1 ring-gray-200 text-gray-800 transition-all hover:text-primary hover:ring-primary hover:-translate-y-0.5 hover:shadow-md">
              <i class="fas fa-save" aria-hidden="true"></i>
              Сохранить
            </button>
          </header>
          <div class="p-6">
            <label for="additionalInfo" class="sr-only">О себе</label>
            <textarea id="additionalInfo"
              placeholder="Расскажите о себе больше, укажите ваши предпочтения в обучении, пожелания или комментарии..."
              class="w-full min-h-[112px] p-3 rounded-xl text-base border border-gray-300 resize-y focus:outline-none focus:border-primary focus:ring-2 focus:ring-emerald-200 transition">{{ request.user.profile.about|default:"" }}</textarea>
          </div>
        </section>
      </div>

      <!-- Right Column -->
      <aside class="space-y-6">
        <!-- Level Status -->
        <section class="bg-white rounded-2xl ring-1 ring-gray-200 shadow-sm overflow-hidden transition-transform duration-300 hover:-translate-y-0.5 hover:shadow-lg">
          <header class="flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gray-50/60">
            <h3 class="text-lg font-bold m-0 inline-flex items-center gap-2">
              <i class="fas fa-chart-line text-primary w-[18px] h-[18px]" aria-hidden="true"></i>
              Уровень языка
            </h3>
          </header>
          <div class="text-center p-6">
            <div class="py-4">
              <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center">
                <i class="fas fa-question text-4xl text-gray-400" aria-hidden="true"></i>
              </div>
              <h4 class="text-lg font-bold text-gray-900 mb-2">Уровень не определён</h4>
              <p class="text-sm text-gray-600 mb-6 px-4">Пройдите тест для определения вашего уровня владения английским языком</p>
              <a href="{% url 'user_test_intro' %}"
                 class="group relative inline-flex items-center justify-center gap-2 px-6 py-3 font-semibold text-base rounded-full bg-gradient-to-r from-primary to-emerald-700 text-white overflow-hidden transition-all hover:-translate-y-0.5 hover:shadow-lg hover:shadow-primary/30 active:brightness-95">
                <span class="absolute inset-0 w-0 bg-emerald-800 transition-all duration-300 group-hover:w-full z-0"></span>
                <i class="fas fa-clipboard-check relative z-10" aria-hidden="true"></i>
                <span class="relative z-10">Пройти тест</span>
                <i class="fas fa-arrow-right relative z-10 transition-transform group-hover:translate-x-1" aria-hidden="true"></i>
              </a>
            </div>
          </div>
        </section>

        <!-- Quick Stats -->
        <section class="bg-white rounded-2xl ring-1 ring-gray-200 shadow-sm overflow-hidden transition-transform duration-300 hover:-translate-y-0.5 hover:shadow-lg">
          <header class="flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gray-50/60">
            <h3 class="text-lg font-bold m-0 inline-flex items-center gap-2">
              <i class="fas fa-trophy text-primary w-[18px] h-[18px]" aria-hidden="true"></i>
              Статистика
            </h3>
          </header>
          <div class="p-6">
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
              <!-- Days streak -->
              <div class="flex items-center gap-4 p-4 rounded-xl bg-gradient-to-br from-amber-50 to-amber-100 ring-1 ring-amber-200/60 transition-all hover:shadow-md hover:-translate-y-0.5">
                <div class="w-10 h-10 rounded-full bg-amber-200 flex items-center justify-center text-amber-800">
                  <i class="fas fa-fire" aria-hidden="true"></i>
                </div>
                <div>
                  <div class="text-2xl font-extrabold text-amber-800">{{ request.user.profile.days_streak|default:0 }}</div>
                  <div class="text-xs font-medium text-amber-700/80">Дней</div>
                </div>
              </div>
              <!-- Words learned -->
              <div class="flex items-center gap-4 p-4 rounded-xl bg-gradient-to-br from-emerald-50 to-emerald-100 ring-1 ring-emerald-200/60 transition-all hover:shadow-md hover:-translate-y-0.5">
                <div class="w-10 h-10 rounded-full bg-emerald-200 flex items-center justify-center text-emerald-800">
                  <i class="fas fa-language" aria-hidden="true"></i>
                </div>
                <div>
                  <div class="text-2xl font-extrabold text-emerald-800">{{ request.user.profile.words_learned|default:0 }}</div>
                  <div class="text-xs font-medium text-emerald-700/80">Слов</div>
                </div>
              </div>
              <!-- Lessons completed -->
              <div class="flex items-center gap-4 p-4 rounded-xl bg-gradient-to-br from-indigo-50 to-indigo-100 ring-1 ring-indigo-200/60 transition-all hover:shadow-md hover:-translate-y-0.5">
                <div class="w-10 h-10 rounded-full bg-indigo-200 flex items-center justify-center text-indigo-800">
                  <i class="fas fa-book-open" aria-hidden="true"></i>
                </div>
                <div>
                  <div class="text-2xl font-extrabold text-indigo-800">{{ request.user.profile.lessons_completed|default:0 }}</div>
                  <div class="text-xs font-medium text-indigo-700/80">Уроков</div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Recent Activity -->
        <section class="bg-white rounded-2xl ring-1 ring-gray-200 shadow-sm overflow-hidden transition-transform duration-300 hover:-translate-y-0.5 hover:shadow-lg">
          <header class="flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-gray-50/60">
            <h3 class="text-lg font-bold m-0 inline-flex items-center gap-2">
              <i class="fas fa-clock text-primary w-[18px] h-[18px]" aria-hidden="true"></i>
              Последняя активность
            </h3>
          </header>
          <div id="recentActivityList" aria-live="polite">
            {% for act in recent_activities %}
              <div class="px-6 py-4 border-b border-gray-100 last:border-b-0 transition-colors hover:bg-gray-50" data-activity="{{ forloop.counter }}">
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-3 font-medium">
                    <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0">
                      <i class="fas fa-clock text-blue-600 text-sm" aria-hidden="true"></i>
                    </div>
                    <span class="text-sm">{{ act }}</span>
                  </div>
                </div>
              </div>
            {% empty %}
              <div class="px-6 py-4 text-gray-500 text-sm">Пока активности нет</div>
            {% endfor %}
          </div>
        </section>
      </aside>
    </div>
  </div>
</main>

<!-- Goals Modal -->
<div id="goalsModal" class="fixed inset-0 z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="goalsModalTitle">
  <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" data-overlay onclick="closeModal('goalsModal')"></div>
  <div class="relative flex min-h-full items-center justify-center p-4">
    <div class="w-full max-w-[500px] overflow-hidden rounded-2xl bg-white shadow-2xl motion-safe:animate-[modalFadeIn_0.25s_ease-out]">
      <div class="flex items-center justify-between px-6 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-gray-100">
        <h2 id="goalsModalTitle" class="text-xl font-bold m-0 inline-flex items-center gap-2">
          <i class="fas fa-target text-primary" aria-hidden="true"></i>
          Добавить новую цель
        </h2>
        <button type="button" class="text-xl text-gray-500 p-2 rounded-full hover:bg-gray-200 hover:text-gray-800 transition"
                onclick="closeModal('goalsModal')" aria-label="Закрыть модалку">
          <i class="fas fa-times" aria-hidden="true"></i>
        </button>
      </div>
      <div class="p-6">
        <div class="mb-6">
          <label class="block mb-2 font-semibold text-gray-800" for="goalTitle">Название цели</label>
          <input type="text" id="goalTitle"
                 class="w-full p-3 border border-gray-300 rounded-xl text-base transition-all focus:outline-none focus:border-primary focus:ring-2 focus:ring-emerald-200"
                 placeholder="Например: Сдать TOEFL на 100 баллов" required>
        </div>
        <div class="flex justify-end gap-3 pt-4 border-t border-gray-100 bg-gray-50 -mx-6 -mb-6 px-6 py-4">
          <button type="button"
                  class="inline-flex items-center gap-2 px-5 py-2.5 rounded-full text-sm font-semibold bg-white ring-1 ring-gray-200 text-gray-800 transition hover:text-primary hover:ring-primary hover:shadow-md"
                  onclick="closeModal('goalsModal')">
            Отмена
          </button>
          <button type="button" onclick="addGoal()"
                  class="inline-flex items-center gap-2 px-5 py-2.5 rounded-full text-sm font-semibold text-white bg-primary hover:bg-emerald-700 transition hover:shadow-md">
            <i class="fas fa-plus" aria-hidden="true"></i>
            Добавить цель
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Interests Modal -->
<div id="interestsModal" class="fixed inset-0 z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="interestsModalTitle">
  <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" data-overlay onclick="closeModal('interestsModal')"></div>
  <div class="relative flex min-h-full items-center justify-center p-4">
    <div class="w-full max-w-[500px] overflow-hidden rounded-2xl bg-white shadow-2xl motion-safe:animate-[modalFadeIn_0.25s_ease-out]">
      <div class="flex items-center justify-between px-6 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-gray-100">
        <h2 id="interestsModalTitle" class="text-xl font-bold m-0 inline-flex items-center gap-2">
          <i class="fas fa-heart text-primary" aria-hidden="true"></i>
          Изменить интересы
        </h2>
        <button type="button" class="text-xl text-gray-500 p-2 rounded-full hover:bg-gray-200 hover:text-gray-800 transition"
                onclick="closeModal('interestsModal')" aria-label="Закрыть модалку">
          <i class="fas fa-times" aria-hidden="true"></i>
        </button>
      </div>
      <div class="p-6">
        <div class="mb-6">
          <span class="block mb-3 font-semibold text-gray-800">Выберите ваши интересы</span>
          <div id="interestsOptions" class="space-y-2">
            {% for interest_name in available_interests %}
              <label class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer">
                <input type="checkbox" value="{{ interest_name }}" class="mr-3 h-4 w-4 text-primary"
                       {% if interest_name in interests_list %}checked{% endif %}>
                <span>{{ interest_name }}</span>
              </label>
            {% empty %}
              <p class="text-sm text-gray-500">Список интересов пуст.</p>
            {% endfor %}
          </div>
        </div>
        <div class="flex justify-end gap-3 pt-4 border-t border-gray-100 bg-gray-50 -mx-6 -mb-6 px-6 py-4">
          <button type="button"
                  class="inline-flex items-center gap-2 px-5 py-2.5 rounded-full text-sm font-semibold bg-white ring-1 ring-gray-200 text-gray-800 transition hover:text-primary hover:ring-primary hover:shadow-md"
                  onclick="closeModal('interestsModal')">
            Отмена
          </button>
          <button type="button" onclick="saveInterests()"
                  class="inline-flex items-center gap-2 px-5 py-2.5 rounded-full text-sm font-semibold text-white bg-primary hover:bg-emerald-700 transition hover:shadow-md">
            <i class="fas fa-save" aria-hidden="true"></i>
            Сохранить изменения
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Модалки
  function openGoalsModal() {
    document.getElementById('goalsModal').classList.remove('hidden');
    setTimeout(() => document.getElementById('goalTitle')?.focus(), 50);
  }
  function openInterestsModal() {
    document.getElementById('interestsModal').classList.remove('hidden');
  }
  function closeModal(modalId) {
    document.getElementById(modalId).classList.add('hidden');
  }
  function editProfile() {
    window.location.href = '/profile/edit/';
  }

  // Поддержка закрытия по Esc
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      ['goalsModal', 'interestsModal'].forEach(id => {
        const el = document.getElementById(id);
        if (el && !el.classList.contains('hidden')) el.classList.add('hidden');
      });
    }
  });

  // Получить текущее состояние из UI
  function getCurrentInterests() {
    return Array.from(document.querySelectorAll('#interestsGrid [data-interest]'))
      .map(el => el.dataset.interest.trim())
      .filter(Boolean);
  }
  function getCurrentGoals() {
    return Array.from(document.querySelectorAll('#goalsList [data-goal]'))
      .map(el => el.dataset.goal.trim())
      .filter(Boolean);
  }

  // Синхронизация скрытых полей
  function syncHiddenFields() {
    const interests = getCurrentInterests();
    const goals = getCurrentGoals();
    const about = document.getElementById('additionalInfo')?.value || '';
    document.getElementById('hiddenInterests').value = interests.join(',');
    document.getElementById('hiddenGoals').value = goals.join(',');
    document.getElementById('hiddenAbout').value = about;
  }

  document.addEventListener('DOMContentLoaded', () => {
    syncHiddenFields();
  });

  // Цели
  function addGoal() {
    const goalTitleEl = document.getElementById('goalTitle');
    const goalTitle = goalTitleEl.value.trim();
    if (!goalTitle) return;

    const goalsList = document.getElementById('goalsList');
    const goalDiv = document.createElement('div');
    goalDiv.className = 'px-6 py-4 transition-colors hover:bg-gray-50 border-t border-gray-100 first:border-t-0';
    goalDiv.setAttribute('data-goal', goalTitle);
    goalDiv.innerHTML = `
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3 font-medium">
          <i class="fas fa-target text-primary w-4" aria-hidden="true"></i>
          <span>${goalTitle}</span>
        </div>
        <div class="flex items-center gap-3">
          <span class="px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800">Активная</span>
          <button type="button" class="text-gray-500 p-1 rounded hover:bg-gray-200 hover:text-gray-800 transition" onclick="removeGoal(this)" aria-label="Удалить цель">
            <i class="fas fa-trash" aria-hidden="true"></i>
          </button>
        </div>
      </div>
    `;
    goalsList.appendChild(goalDiv);

    goalTitleEl.value = '';
    closeModal('goalsModal');

    // сохранить в БД
    syncHiddenFields();
    document.getElementById('profileForm').submit();
  }
  function removeGoal(el) {
    const goalDiv = el.closest('[data-goal]');
    if (goalDiv) goalDiv.remove();
    syncHiddenFields();
    document.getElementById('profileForm').submit();
  }

  // Интересы
  function saveInterests() {
    const checkboxes = document.querySelectorAll('#interestsOptions input:checked');
    const interests = Array.from(checkboxes).map(cb => cb.value.trim()).filter(Boolean);

    // Обновить теги
    const grid = document.getElementById('interestsGrid');
    grid.innerHTML = '';
    interests.forEach(interest => {
      const div = document.createElement('div');
      div.className = 'interest-tag group inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200 text-sm font-medium transition-all hover:shadow-md hover:-translate-y-0.5';
      div.setAttribute('data-interest', interest);
      div.innerHTML = `
        <i class="fas fa-heart w-4" aria-hidden="true"></i>
        <span>${interest}</span>
        <button type="button" class="ml-1 inline-flex items-center justify-center rounded-full p-1 text-gray-500 hover:text-gray-800 hover:bg-blue-100 transition hidden group-hover:inline-flex" onclick="removeInterest(this, event)" aria-label="Удалить интерес">
          <i class="fas fa-times" aria-hidden="true"></i>
        </button>
      `;
      grid.appendChild(div);
    });

    closeModal('interestsModal');

    // сохранить в БД
    syncHiddenFields();
    document.getElementById('profileForm').submit();
  }
  function removeInterest(el, event) {
    event.stopPropagation();
    const tag = el.closest('.interest-tag');
    if (tag) tag.remove();
    syncHiddenFields();
    document.getElementById('profileForm').submit();
  }

  // О себе
  function saveAdditionalInfo() {
    syncHiddenFields();
    document.getElementById('profileForm').submit();
  }

  // Закрытие модалок по клику на подложку (дополнительно к data-overlay)
  window.addEventListener('click', function(event) {
    if (event.target?.hasAttribute?.('data-overlay')) {
      const parent = event.target.closest('[role="dialog"]');
      if (parent?.id) closeModal(parent.id);
    }
  });
</script>

<style>
  @keyframes modalFadeIn {
    from { opacity: 0; transform: translateY(-12px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
{% endblock %}